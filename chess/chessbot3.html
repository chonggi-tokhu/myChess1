<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mychess</title>
    <link rel="stylesheet" href="./chessboardjs-1.0.0/css/chessboard-1.0.0.min.css">
    <style>
        :root {
            --displaywidth: 100px;
        }

        .oneOfMyBoards .board-b72b1 {
            width: inherit !important;
        }

        @keyframes fadeOut {
            from {
                opacity: 1
            }

            to {
                opacity: 0;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
    <chessopt chessinmodule="false"></chessopt>
</head>

<body>
    <div class="body">
        <div id="myBoard" style="width: 40em;">
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.3.js"></script>
    <script src="./chess_cjs_2.js"></script>
    <script src="./chessboardjs-1.0.0/js/chessboard-1.0.0.min.js"></script>
    <script src="./chess2.js"></script>
    <script src="./chessBotModule/myChessBot.js"></script>
    <script src="./chessBotModule/evaluateBoard.js"></script>
    <script src="./chessBotModule/core.js"></script>
    <!--<script src="./chessauto.js" id="scriptSRCchess"></script>
    <script>
        if (document.head.getElementsByTagName("chessopt")[0].getAttribute("chessinmodule") == "true") {
            var myScriptTag = document.getElementById("scriptSRCchess");
            myScriptTag.setAttribute("src", "./chessauto_module.js");
            myScriptTag.setAttribute("type", "module");
            myScriptTag.innerHTML = `import { docChess } from "./chessauto_module.js"`;
            myScriptTag.innerHTML += `window['docChess']=docChess;`;
        }
        window.addEventListener("DOMContentLoaded",function(){
            window.chessauto
        })
    </script>-->
    <script>
        var board = null
        var game = new Chess()
        game.load('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1');
        function onDragStart(source, piece, position, orientation) {
            // do not pick up pieces if the game is over
            if (game.game_over()) return false

            // only pick up pieces for White
            if (piece.search(/^b/) !== -1) return false
        }

        function makeRandomMove() {
            var bestMove = myChessBot.core.minimax(game, 3, -10, 10, true, 0, 'b')[0].san;
            game.move(bestMove);
            board.position(game.fen())
        }

        function onDrop(source, target) {
            // see if the move is legal
            var move = game.move({
                from: source,
                to: target,
                promotion: 'q' // NOTE: always promote to a queen for example simplicity
            })

            // illegal move
            if (move === null) return 'snapback'
            if (game.game_over()) return false;
            // make random legal move for black
            window.setTimeout(makeRandomMove, 250)
        }

        // update the board position after the piece snap
        // for castling, en passant, pawn promotion
        function onSnapEnd() {
            board.position(game.fen())
        }
        function pieceTheme(piece) {
            return './chessboardjs-1.0.0/img/chesspieces/wikipedia/' + piece + '.png'
        }
        var config = {
            draggable: true,
            pieceTheme: pieceTheme,
            position: 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',
            onDragStart: onDragStart,
            onDrop: onDrop,
            onSnapEnd: onSnapEnd
        }
        board = Chessboard('myBoard', config);
        document.querySelectorAll('#myBoard img', function (val, key, par) {
            val.setAttrubute("draggable", "true");
        })
    </script>
</body>

</html>